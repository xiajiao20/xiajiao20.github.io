<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>文档教程</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      display: flex;
      height: 100vh;
    }
    #sidebar {
          width: 260px;
          background: #f8f8f8;
          border-right: 1px solid #ddd;
          display: flex;
          flex-direction: column;
              position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        overflow-y: auto;
        z-index: 100;
    }
    #tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
    }
    #tabs button {
      flex: 1;
      padding: 10px;
      border: none;
      background: #f8f8f8;
      cursor: pointer;
    }
    #tabs button.active {
      background: #fff;
      border-bottom: 2px solid #007bff;
      font-weight: bold;
    }
    .tab-content {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
    }
    .tab-content ul {
      list-style: none;
      padding-left: 10px;
    }
    .tab-content li {
      margin: 5px 0;
    }
    .tab-content a {
      text-decoration: none;
      color: #333;
    }
    .tab-content a:hover {
      color: #007bff;
    }
    #content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <div id="tabs">
      <button id="filesTab" class="active">文件</button>
      <button id="outlineTab">大纲</button>
    </div>
    <div id="files" class="tab-content"></div>
    <div id="outline" class="tab-content" style="display:none;"></div>
  </div>

  <div id="content">
    <h2>欢迎</h2>
    <p>请选择左侧的文档。</p>
  </div>

  <script>
    // 自动生成的文件列表（Python 脚本会替换这里）
    const files = ['Python 入门指南.html', '第一次答疑课.html', '第二次答疑课.html'];

    const filesDiv = document.getElementById("files");
    const outlineDiv = document.getElementById("outline");
    const content = document.getElementById("content");

    // === 文件 Tab ===
    const ul = document.createElement("ul");
    files.forEach(file => {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.textContent = file.replace(".html", "");
      a.href = "#";
      a.onclick = (e) => {
        e.preventDefault();
        loadDoc(file);
      };
      li.appendChild(a);
      ul.appendChild(li);
    });
    filesDiv.appendChild(ul);

    // === 加载文档内容并生成大纲 ===
    function loadDoc(file) {
      fetch("docs/" + encodeURIComponent(file))
        .then(res => res.text())
        .then(html => {
          content.innerHTML = html;
          buildOutline();
        })
        .catch(err => {
          content.innerHTML = "<p style='color:red;'>加载失败: " + err + "</p>";
          outlineDiv.innerHTML = "";
        });
    }

    // === 构建大纲 ===
    function buildOutline() {
      outlineDiv.innerHTML = "";
      const headings = content.querySelectorAll("h1, h2, h3");
      if (headings.length === 0) {
        outlineDiv.innerHTML = "<p>（无大纲）</p>";
        return;
      }
      const ul = document.createElement("ul");
      headings.forEach(h => {
        const li = document.createElement("li");
        li.style.marginLeft = (parseInt(h.tagName[1]) - 1) * 15 + "px";
        const a = document.createElement("a");
        a.textContent = h.textContent;
        a.href = "#";
        a.onclick = (e) => {
          e.preventDefault();
          h.scrollIntoView({ behavior: "smooth" });
        };
        li.appendChild(a);
        ul.appendChild(li);
      });
      outlineDiv.appendChild(ul);
    }

    // === Tab 切换 ===
    document.getElementById("filesTab").onclick = () => {
      document.getElementById("filesTab").classList.add("active");
      document.getElementById("outlineTab").classList.remove("active");
      filesDiv.style.display = "block";
      outlineDiv.style.display = "none";
    };
    document.getElementById("outlineTab").onclick = () => {
      document.getElementById("outlineTab").classList.add("active");
      document.getElementById("filesTab").classList.remove("active");
      filesDiv.style.display = "none";
      outlineDiv.style.display = "block";
    };
  </script>
</body>
</html>
